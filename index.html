<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no" />
<title>Swipe Link Tree with Collapse</title>
<style>
* { box-sizing: border-box; }

html, body {
  margin:0; padding:0;
  overflow:hidden;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background:black;
  height:100%;
  touch-action: pan-y;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Container & Pages */
.container {
  display:flex;
  width:300vw;
  height:100vh;
  will-change: transform;
  transition: transform 0.45s cubic-bezier(.22,.61,.36,1);
  touch-action: pan-y;
}

.page {
  width:100vw;
  height:100vh;
  flex-shrink: 0;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding: 5vh 3vw;
  color: #222;
  background: transparent;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
}

/* --- Page 1: Link Tree --- */
.page1 {
  background: #d1f0d9;
  color: #222;
}

/* Link Tree Card */
.linktree-card {
  background: #ffffff;
  border-radius: 20px;
  padding-bottom: 20px;
  width: 90vw;
  max-width: 360px;
  box-shadow: 0 8px 24px rgb(145, 184, 155 / 0.4);
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 30px;
}

.profile-photo {
  width: 90vw;
  max-width: 360px;
  max-height: 150px;
  border-radius: 20px 20px 0 0;
  object-fit: cover;
  margin-bottom: 15px;
  opacity: 0;
  transition: opacity 0.4s ease;
}

.profile-photo[src] {
  opacity: 1;
}

.name {
  font-weight: 700;
  font-size: 1.3rem;
  margin: 0 0 6px 0;
  text-align: center;
}

.desc {
  font-size: 0.9rem;
  color: #444;
  text-align: center;
  margin-bottom: 15px;
}

.btn-message {
  background: #ec1a8f;
  color: white;
  border: none;
  border-radius: 25px;
  padding: 10px 35px;
  font-weight: 700;
  font-size: 1rem;
  cursor: pointer;
  transition: background-color 0.3s ease;

  -webkit-tap-highlight-color: transparent;
  outline: none;
  user-select: none;
}

.btn-message:hover {
  background: #c2177d;
}

/* Link Buttons */
.links {
  width: 90vw;
  max-width: 360px;
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.link-btn {
  width: 90vw;
  max-width: 360px;
  background: #ffffff;
  border-radius: 10px;
  border: none;
  padding: 14px 20px;
  font-weight: 600;
  font-size: 1rem;
  text-align: left;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 12px;
  color: #222;
  box-shadow: 0 8px 24px rgb(145, 184, 155 / 0.4);
  transition: background-color 0.3s ease;
  margin-top: 13px;
  -webkit-tap-highlight-color: transparent;
  outline: none;
  user-select: none;
  position: relative;
}

.link-btn:hover {
  background: #628c6d;
}

/* Icons for links using emoji placeholders */
.link-btn span {
  font-size: 1.2rem;
  display: inline-block;
  width: 28px;
  text-align: center;
}

/* Collapse panel container */
.collapse-panel {
  overflow: hidden;
  max-height: 0;
  padding-top: 0;
  padding-bottom: 0;
  transition:
    max-height 0.35s ease,
    padding-top 0.35s ease,
    padding-bottom 0.35s ease;
  padding-left: 14px;
  margin-top: -13px;
  color: #666;
  font-size: 0.9rem;
  background: #edfff2;
  border-radius: 10px;
  box-shadow: 0 8px 24px rgb(145, 184, 155 / 0.4);
  user-select: none;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.collapse-panel.open {
  max-height: 90px; /* adjust if needed */
  padding-top: 25px;
  padding-bottom: 8px;
}


/* Visit button inside collapse */
.collapse-panel button.visit-btn {
  background: #628c6d;
  color: white;
  border: none;
  border-radius: 18px;
  padding: 6px 16px;
  font-weight: 600;
  font-size: 0.9rem;
  cursor: pointer;
  transition: background-color 0.3s ease;
  margin-right:10px;
  -webkit-tap-highlight-color: transparent;
  outline: none;
  user-select: none;
}

.collapse-panel button.visit-btn:hover {
  background: #789e82;
}

/* --- Page 2 and 3 --- */
.page2 {
  background: #0b1220;
  color: white;
  justify-content: flex-start;
  padding-top: 6vh;
}

.page-title {
  font-size: 1.6rem;
  margin-bottom: 20px;
  text-align: center;
}

.codes-section {
  width: 100%;
  max-width: 420px;
  margin-bottom: 32px;
}

.codes-section h3 {
  font-size: 1.2rem;
  margin-bottom: 12px;
  border-bottom: 1px solid rgba(255,255,255,0.2);
  padding-bottom: 6px;
}

.code-card {
  background: rgba(255,255,255,0.08);
  border-radius: 14px;
  padding: 14px 16px;
  margin-bottom: 12px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.35);
}

.code-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

.code-text {
  font-weight: 700;
  letter-spacing: 0.5px;
  font-size: 0.95rem;
  word-break: break-all;
}

.copy-btn {
  background: #38bdf8;
  color: #020617;
  border: none;
  border-radius: 999px;
  padding: 6px 14px;
  font-size: 0.8rem;
  font-weight: 700;
  cursor: pointer;
  flex-shrink: 0;
}

.copy-btn:active {
  transform: scale(0.95);
}

.code-desc {
  margin-top: 6px;
  font-size: 0.85rem;
  opacity: 0.85;
  line-height: 1.4;
}

.loading {
  opacity: 0.7;
  text-align: center;
}

.section-header {
  position: relative;
  height: 120px;
  border-radius: 16px;
  overflow: hidden;
  margin-bottom: 16px;
  display: flex;
  align-items: flex-end;
  padding: 14px 16px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.45);
  background-size: cover;
  background-position: center;
}

.section-header::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to top,
    rgba(0,0,0,0.75),
    rgba(0,0,0,0.25)
  );
}

.section-header h3 {
  position: relative;
  margin: 0;
  font-size: 1.2rem;
  font-weight: 700;
  z-index: 1;
}




.page3 {
  background: #064e3b;
  color: white;
  font-weight: bold;
  font-size: 2rem;
  justify-content: center;
}

/* Island dot indicator */
.island {
  position: fixed;
  top: 2vh;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(14px);
  padding: 1vh 3vw;
  border-radius: 999px;
  display: flex;
  gap: 2vw;
  opacity: 0;
  transition: opacity 0.25s ease;
  pointer-events: none;
  z-index: 999;
}

.island.show {
  opacity: 1;
}

.dot-wrapper {
  position: relative;
  width: 60px;
  height: 14px;
}

.dot {
  width: 8px;
  height: 8px;
  background: #666;
  border-radius: 50%;
  position: absolute;
  top: 0;
  margin-top:3px;
  transition: all 0.25s ease;
}

.dot-indicator {
  position: absolute;
  top: 0;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: white;
  transition: left 0.1s linear;
}

/* FAB Buttons for desktop */
.fab {
  position: fixed;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(255 255 255 / 0.2);
  backdrop-filter: blur(10px);
  color: white;
  border: none;
  border-radius: 50%;
  width: 44px;
  height: 44px;
  font-size: 24px;
  cursor: pointer;
  display: none;
  align-items: center;
  justify-content: center;
  user-select: none;
  z-index: 1000;
  transition: background-color 0.3s ease;
}

.fab:hover {
  background: rgba(255 255 255 / 0.4);
}

.fab-left {
  left: 12px;
}

.fab-right {
  right: 12px;
}

/* Show FAB on desktop */
@media (min-width: 800px) {
  .fab {
    display: flex;
  }
}
</style>
</head>
<body>

<div class="container" id="container">
  <!-- Page 1 Link Tree -->
  <div class="page page1">
    <div class="linktree-card">
      <img id="banner" alt="Banner Image" class="profile-photo" />
      <h2 class="name">Eina Antaswari Kinanthi</h2>
      <p class="desc">Senior UI/UX Designer with big dreams. üöÄ</p>
      <button class="btn-message">Message me</button>
    </div>
    <div class="links">
      <!-- Each link-btn with collapse panel -->
      <div>
        <button class="link-btn"><span>üèÄ</span> My Dribbble</button>
        <div class="collapse-panel">
          <div>visit me</div>
          <button class="visit-btn" onclick="alert('Dribbble clicked')">Go</button>
        </div>
      </div>
      <div>
        <button class="link-btn"><span>üé®</span> Freebies UI Kit</button>
        <div class="collapse-panel">
          <div>visit me</div>
          <button class="visit-btn" onclick="alert('Freebies clicked')">Go</button>
        </div>
      </div>
      <div>
        <button class="link-btn"><span>üîó</span> My Linkedin</button>
        <div class="collapse-panel">
          <div>visit me <br> everytime u wanted </div>
          <button class="visit-btn" onclick="alert('Linkedin clicked')">Go</button>
        </div>
      </div>
      <div>
        <button class="link-btn"><span>üìù</span> Just write my thoughts</button>
        <div class="collapse-panel">
          <div>visit me</div>
          <button class="visit-btn" onclick="alert('Thoughts clicked')">Go</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Page 2 -->
  <div class="page page2">
  <h2 class="page-title">üéÅ Redeem Codes</h2>

  <div id="codes-container">
    <div class="loading">Loading codes...</div>
  </div>
</div>

  <!-- Page 3 -->
  <div class="page page3"><h1>Page 3</h1></div>
</div>

<!-- Island dot indicator -->
<div class="island" id="island">
  <div class="dot-wrapper">
    <div class="dot" style="left:0;"></div>
    <div class="dot" style="left:23px;"></div>
    <div class="dot" style="left:46px;"></div>
    <div class="dot-indicator" id="dot-indicator"></div>
  </div>
</div>

<!-- FAB Buttons -->
<button class="fab fab-left" id="btnPrev" aria-label="Previous page">&lt;</button>
<button class="fab fab-right" id="btnNext" aria-label="Next page">&gt;</button>

<script>
/* ================================
   Swipe Navigation
   ================================ */

const container = document.getElementById("container");
const island = document.getElementById("island");
const dotIndicator = document.getElementById("dot-indicator");
const btnPrev = document.getElementById("btnPrev");
const btnNext = document.getElementById("btnNext");

let totalPages = 3;
let pageWidth = window.innerWidth;

let currentPage = 0;
let startX = 0;
let currentX = 0;
let startTime = 0;
let isSwiping = false;
let hideTimeout = null;
let startY = 0;
let currentY = 0;
let gestureLocked = false;
let isHorizontalSwipe = false;
  
function setTranslate(x){
  container.style.transform = `translateX(${x}px)`;
}

function updateDotIndicator(progress){
  dotIndicator.style.left =
    `${Math.min(Math.max(progress,0),totalPages-1)*23}px`;
}

function showIsland(){
  clearTimeout(hideTimeout);
  island.classList.add("show");
  hideTimeout = setTimeout(() => {
    island.classList.remove("show");
  }, 1000);
}

function goToPage(page){
  if(page < 0) page = 0;
  if(page >= totalPages) page = totalPages - 1;
  currentPage = page;
  container.style.transition =
    "transform 0.45s cubic-bezier(.22,.61,.36,1)";
  setTranslate(-currentPage*pageWidth);
  updateDotIndicator(currentPage);
  showIsland();
}

window.addEventListener('resize', ()=>{
  pageWidth = window.innerWidth;
  setTranslate(-currentPage*pageWidth);
});

document.addEventListener("touchstart", e => {
  clearTimeout(hideTimeout);

  startX = e.touches[0].clientX;
  startY = e.touches[0].clientY;

  currentX = startX;
  currentY = startY;

  startTime = Date.now();

  isSwiping = true;
  gestureLocked = false;
  isHorizontalSwipe = false;

  island.classList.add("show");
}, { passive: true });

document.addEventListener("touchmove", e => {
  if (!isSwiping) return;

  currentX = e.touches[0].clientX;
  currentY = e.touches[0].clientY;

  const dx = currentX - startX;
  const dy = currentY - startY;

  // Lock gesture direction once movement is clear
  if (!gestureLocked) {
    if (Math.abs(dx) > 10 || Math.abs(dy) > 10) {
      gestureLocked = true;
      isHorizontalSwipe = Math.abs(dx) > Math.abs(dy);
    } else {
      return; // wait until movement is meaningful
    }
  }

  // Ignore vertical gestures
  if (!isHorizontalSwipe) return;

  let delta = dx;

  if ((currentPage === 0 && delta > 0) ||
      (currentPage === totalPages - 1 && delta < 0)) {
    delta *= 0.3;
  } else {
    delta *= 0.6;
  }

  const offset = -currentPage * pageWidth + delta;
  container.style.transition = "none";
  setTranslate(offset);

  const progress = currentPage - delta / pageWidth;
  updateDotIndicator(progress);
}, { passive: true });


document.addEventListener("touchend", () => {
  if (!isSwiping) return;
  isSwiping = false;

  // If it wasn't a horizontal swipe, do nothing
  if (!isHorizontalSwipe) {
    island.classList.remove("show");
    return;
  }

  const distance = currentX - startX;
  const time = Date.now() - startTime;
  const velocity = Math.abs(distance / time);

  if (
    distance < -50 &&
    (Math.abs(distance) > 80 || velocity > 0.5) &&
    currentPage < totalPages - 1
  ) {
    currentPage++;
  } else if (
    distance > 50 &&
    (Math.abs(distance) > 80 || velocity > 0.5) &&
    currentPage > 0
  ) {
    currentPage--;
  }

  container.style.transition =
    "transform 0.45s cubic-bezier(.22,.61,.36,1)";
  setTranslate(-currentPage * pageWidth);
  updateDotIndicator(currentPage);

  hideTimeout = setTimeout(() => {
    island.classList.remove("show");
  }, 1000);
});


btnPrev.onclick = () => currentPage > 0 && goToPage(currentPage - 1);
btnNext.onclick = () => currentPage < totalPages - 1 && goToPage(currentPage + 1);

setTranslate(0);
updateDotIndicator(0);

document.querySelectorAll(".link-btn").forEach(btn => {
  btn.addEventListener('click', () => {
    const panel = btn.nextElementSibling;
    const isOpen = panel.classList.contains('open');
    
    document.querySelectorAll('.collapse-panel.open').forEach(p => {
      if(p !== panel) p.classList.remove('open');
    }); 
    panel.classList.toggle('open', !isOpen);
  });
});

/* ================================
   Page 1: Profile Banner (Star Rail)
   ================================ */

const bannerImg = document.getElementById("banner");
const PROFILE_CACHE_KEY = "hsr_profile_banner";

const cachedProfile = localStorage.getItem(PROFILE_CACHE_KEY);
if (cachedProfile) bannerImg.src = cachedProfile;

fetch("https://api.allorigins.win/raw?url=https://api.ennead.cc/mihoyo/starrail/news/notices")
  .then(res => res.json())
  .then(data => {
    const notice = [...data].reverse().find(n => n.banner?.length);
    const bannerUrl = notice?.banner?.[0];
    if (!bannerUrl || bannerUrl === cachedProfile) return;
    bannerImg.src = bannerUrl;
    localStorage.setItem(PROFILE_CACHE_KEY, bannerUrl);
  })
  .catch(console.error);

/* ================================
   Shared Banner Loader (Page 2)
   ================================ */

function loadHoYoBanner({ key, api, target }) {
  const CACHE_KEY = `hoyo_banner_${key}`;
  const cached = localStorage.getItem(CACHE_KEY);

  if (cached) {
    target.style.backgroundImage = `url(${cached})`;
  }

  fetch(api)
    .then(res => res.json())
    .then(data => {
      if (!Array.isArray(data)) return;

      let bannerUrl = null;

      // ‚≠ê STAR RAIL = SAME AS PROFILE BANNER
      if (key === "starrail") {
        const notice = [...data].reverse().find(n => n.banner?.length);
        bannerUrl = notice?.banner?.at(-1);
      }

      // üéÆ GENSHIN / ZZZ (safe fallback)
      else {
        const notice = [...data].reverse().find(n => n.banner?.length);
        const banners = notice?.banner || [];
        bannerUrl = banners.at(-1) || banners[0];
      }

      if (!bannerUrl || bannerUrl === cached) return;

      target.style.backgroundImage = `url(${bannerUrl})`;
      localStorage.setItem(CACHE_KEY, bannerUrl);
    })
    .catch(err => console.error(`Banner fetch error (${key})`, err));
}


/* ================================
   Page 2: Codes Rendering
   ================================ */

const codesContainer = document.getElementById("codes-container");

fetch("https://db.hashblen.com/codes")
  .then(res => res.json())
  .then(data => {
    codesContainer.innerHTML = "";
    Object.entries(data).forEach(([key, list]) => {
      if (Array.isArray(list) && list.length) renderSection(key, list);
    });
  })
  .catch(() => codesContainer.textContent = "Failed to load codes.");

function renderSection(gameKey, list) {
  const section = document.createElement("div");
  section.className = "codes-section";

  const header = document.createElement("div");
  header.className = "section-header";
  header.innerHTML = `<h3>${formatTitle(gameKey)} Codes</h3>`;
  section.appendChild(header);

  const bannerApis = {
    zzz: "https://api.allorigins.win/raw?url=https://api.ennead.cc/mihoyo/zenless/news/notices",
    genshin: "https://api.allorigins.win/raw?url=https://api.ennead.cc/mihoyo/genshin/news/notices",
    starrail: "https://api.allorigins.win/raw?url=https://api.ennead.cc/mihoyo/starrail/news/notices"
  };

  if (bannerApis[gameKey]) {
    loadHoYoBanner({ key: gameKey, api: bannerApis[gameKey], target: header });
  }

  list.sort((a, b) => b.added_at - a.added_at).forEach(item => {
    const card = document.createElement("div");
    card.className = "code-card";
    card.innerHTML = `
      <div class="code-row">
        <div class="code-text">${item.code}</div>
        <button class="copy-btn">Copy</button>
      </div>
      <div class="code-desc">${item.description}</div>
    `;
    card.querySelector(".copy-btn").onclick = () => {
      navigator.clipboard.writeText(item.code);
      showCopied(card);
    };
    section.appendChild(card);
  });

  codesContainer.appendChild(section);
}

function showCopied(card) {
  const btn = card.querySelector(".copy-btn");
  btn.textContent = "Copied!";
  setTimeout(() => (btn.textContent = "Copy"), 1200);
}

function formatTitle(key) {
  return key.charAt(0).toUpperCase() + key.slice(1);
}
</script>



</body>
</html>
